---
import { getLangFromUrl, useTranslations } from '../i18n/utils';
import BaseLayout from '../layouts/BaseLayout.astro';
import { languages } from '../i18n/ui';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<BaseLayout title={t('site.name')}>
	<main>
		<section class="hero container">
			<h1>{t('hero.title')}</h1>
			<p>{t('hero.subtitle')}</p>
			<div class="hero-btns" style="display: flex; flex-direction: column; align-items: center; gap: 0.8rem;">
				<div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
					<a href="/download/Aion.dmg" class="btn btn-primary">{t('hero.download')}</a>
					<a href="#features" class="btn" style="border: 1px solid var(--border);">{t('hero.learn')}</a>
				</div>
				<p class="system-requirement">{t('hero.system')}</p>
			</div>
			
				<div class="carousel-container">
					<div class="carousel-track" id="carouselTrack">
						{[8, 6, 7, 2, 3].map((num, i) => (
							<div class="carousel-slide" style={`background-image: url('/screen-${num}.jpg');`}>
								<div class="carousel-overlay"></div>
								<div class="carousel-content">
									<img src="/logo-clean.png" alt="Aion Logo" class="carousel-logo" />
									<h2>{t(`carousel.s${i+1}.title`)}</h2>
									<p>{t(`carousel.s${i+1}.desc`)}</p>
								</div>
							</div>
						))}
					</div>

					<!-- Navigation Dots -->
					<div class="carousel-dots">
						{[0, 1, 2, 3, 4].map((i) => (
							<button class="dot" data-index={i}></button>
						))}
					</div>
				</div>

				<style>
					.dot.active {
		background: #fff !important;
		width: 24px !important;
		border-radius: 4px !important;
	}

	.carousel-container {
		border-radius: 24px;
		overflow: hidden;
		background: #050505;
		position: relative;
		height: 500px;
		margin-top: 60px;
		border: 1px solid rgba(255,255,255,0.1);
		box-shadow: 0 40px 100px rgba(0,0,0,0.8);
	}

	.carousel-track {
		display: flex;
		height: 100%;
		transition: transform 0.6s cubic-bezier(0.645, 0.045, 0.355, 1);
	}

	.carousel-slide {
		flex: 0 0 100%;
		height: 100%;
		position: relative;
		background-size: contain;
		background-position: right center;
		background-repeat: no-repeat;
	}

	.carousel-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(90deg, #050505 0%, #050505 30%, transparent 100%);
		z-index: 1;
	}

	.carousel-content {
		position: absolute;
		top: 0;
		left: 0;
		height: 100%;
		width: 50%;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: flex-start;
		padding: 0 60px;
		text-align: left;
		z-index: 2;
	}

	.carousel-logo {
		width: 64px;
		height: 64px;
		margin-bottom: 24px;
	}

	.carousel-content h2 {
		font-size: 2.5rem;
		color: #fff;
		margin-bottom: 16px;
		font-weight: 800;
		line-height: 1.2;
	}

	.carousel-content p {
		font-size: 1.1rem;
		color: rgba(255,255,255,0.6);
		line-height: 1.6;
		max-width: 400px;
	}

	.carousel-dots {
		position: absolute;
		bottom: 30px;
		left: 60px;
		display: flex;
		gap: 12px;
		z-index: 10;
	}

	.dot {
		width: 8px;
		height: 8px;
		border-radius: 50%;
		background: rgba(255,255,255,0.2);
		border: none;
		cursor: pointer;
		transition: all 0.3s ease;
		padding: 0;
	}

	.system-requirement {
		font-size: 0.85rem;
		color: var(--text-muted);
		opacity: 0.7;
		margin: 0;
	}

	@media (max-width: 768px) {
		.carousel-container {
			height: auto;
			min-height: 600px;
		}
		.carousel-slide {
			background-position: center bottom !important;
			background-size: contain !important; /* Ensure image fits */
			display: flex;
			flex-direction: column;
			max-width: 100%;
		}
		.carousel-overlay {
			background: linear-gradient(180deg, #050505 0%, #050505 50%, transparent 100%);
		}
		.carousel-content {
			width: 100%;
			height: 50%; /* Leave more space for image */
			padding: 40px 20px;
			align-items: center;
			text-align: center;
			position: relative; /* Remove absolute positioning on mobile */
		}
		.carousel-content h2 {
			font-size: 1.6rem;
		}
		.carousel-dots {
			left: 50%;
			transform: translateX(-50%);
			bottom: 10px;
		}
	}

	.faq-item {
		margin-bottom: 1rem;
		background: rgba(255, 255, 255, 0.03);
		border-radius: 12px;
		border: 1px solid var(--border);
		transition: all 0.3s ease;
	}

	.faq-item:hover {
		border-color: rgba(255, 255, 255, 0.2);
		background: rgba(255, 255, 255, 0.05);
	}

	.faq-item summary {
		padding: 1.5rem;
		cursor: pointer;
		list-style: none;
		font-weight: 600;
		font-size: 1.1rem;
		display: flex;
		justify-content: space-between;
		align-items: center;
		outline: none;
	}

	.faq-item summary::-webkit-details-marker {
		display: none;
	}

	.faq-content {
		padding: 0 1.5rem 1.5rem;
		color: var(--text-secondary);
		line-height: 1.6;
		font-size: 1rem;
	}

	.faq-item[open] .chevron {
		transform: rotate(180deg);
	}

	.chevron {
		transition: transform 0.3s ease;
		color: var(--text-secondary);
	}
</style>

				<script>
					const track = document.getElementById('carouselTrack');
					const dots = document.querySelectorAll('.dot');
					let currentIndex = 0;
					const slideCount = 5;

					const updateCarousel = (index) => {
						if (!track) return;
						currentIndex = index;
						track.style.transform = `translateX(-${index * 100}%)`;
						
						dots.forEach((dot, i) => {
							if (i === index) dot.classList.add('active');
							else dot.classList.remove('active');
						});
					};

					dots.forEach(dot => {
						dot.addEventListener('click', () => {
							const index = parseInt(dot.getAttribute('data-index'));
							updateCarousel(index);
						});
					});

					// Auto-play
					setInterval(() => {
						currentIndex = (currentIndex + 1) % slideCount;
						updateCarousel(currentIndex);
					}, 5000);

					// Initial state
					updateCarousel(0);
				</script>
		</section>

		<section id="features" class="container" style="padding: 100px 0;">
			<h2 style="font-size: 2.5rem; text-align: center; margin-bottom: 4rem;">{t('features.title')}</h2>
			<div class="features">
				<div class="feature-card">
					<div style="font-size: 2rem; margin-bottom: 1rem; color: var(--primary);">
						<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
					</div>
					<h3>{t('features.autoquit.title')}</h3>
					<p>{t('features.autoquit.desc')}</p>
				</div>
				<div class="feature-card">
					<div style="font-size: 2rem; margin-bottom: 1rem; color: var(--primary);">
						<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
					</div>
					<h3>{t('features.scenes.title')}</h3>
					<p>{t('features.scenes.desc')}</p>
				</div>
				<div class="feature-card">
					<div style="font-size: 2rem; margin-bottom: 1rem; color: var(--primary);">
						<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
					</div>
					<h3>{t('features.smart.title')}</h3>
					<p>{t('features.smart.desc')}</p>
				</div>
				<div class="feature-card">
					<div style="font-size: 2rem; margin-bottom: 1rem; color: var(--primary);">
						<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
					</div>
					<h3>{t('features.stats.title')}</h3>
					<p>{t('features.stats.desc')}</p>
				</div>
				<div class="feature-card">
					<div style="font-size: 2rem; margin-bottom: 1rem; color: var(--primary);">
						<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
					</div>
					<h3>{t('features.focus.title')}</h3>
					<p>{t('features.focus.desc')}</p>
				</div>
				<div class="feature-card">
					<div style="font-size: 2rem; margin-bottom: 1rem; color: var(--primary);">
						<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><circle cx="12" cy="11" r="3"/></svg>
					</div>
					<h3>{t('features.privacy.title')}</h3>
					<p>{t('features.privacy.desc')}</p>
				</div>
			</div>
		</section>

		<section id="pricing" class="container" style="padding: 100px 0; text-align: center;">
			<h2 style="font-size: 2.5rem; margin-bottom: 1rem;">{t('pricing.title')}</h2>
			<p style="color: var(--text-secondary); margin-bottom: 4rem;">{t('pricing.subtitle')}</p>
			
			<div class="pricing-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; max-width: 800px; margin: 0 auto;">
				<div class="feature-card lite-card" style="display: flex; flex-direction: column; align-items: center;">
					<h3 style="margin-bottom: 0.5rem; color: #fff;">{t('pricing.lite')}</h3>
					<div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 1.5rem; color: #fff;">$0</div>
					<ul style="list-style: none; text-align: left; margin-bottom: 2rem; color: var(--text-secondary); width: 100%;">
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.autoquit')}</li>
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.whitelist')}</li>
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.stats')}</li>
						<li style="margin-bottom: 0.8rem; opacity: 0.5;">✗ {t('pricing.feature.scenes')}</li>
						<li style="margin-bottom: 0.8rem; opacity: 0.5;">✗ {t('pricing.feature.support')}</li>
					</ul>
					<div style="display: flex; flex-direction: column; align-items: center; gap: 0.8rem; width: 100%;">
						<a href="/download/Aion.dmg" class="btn" style="border: 1px solid var(--border); width: 100%;">{t('hero.download')}</a>
						<p class="system-requirement">{t('hero.system')}</p>
					</div>
				</div>
				
				<div class="feature-card pro-card" style="display: flex; flex-direction: column; align-items: center; border-color: var(--primary); position: relative;">
					<div style="position: absolute; top: -15px; background: var(--primary); padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 700;">{t('pricing.best')}</div>
					<h3 style="margin-bottom: 0.5rem; color: #fff;">{t('pricing.pro')}</h3>
					<div style="display: flex; align-items: baseline; gap: 0.5rem; margin-bottom: 1.5rem;">
						<span style="text-decoration: line-through; color: var(--text-secondary); font-size: 1.5rem;">$14.99</span>
						<span style="font-size: 2.5rem; font-weight: 800; color: var(--primary);">$9.99</span>
					</div>
					<ul style="list-style: none; text-align: left; margin-bottom: 2rem; color: var(--text-secondary); width: 100%;">
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.free_base')}</li>
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.scenes')}</li>
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.rules')}</li>
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.support')}</li>
						<li style="margin-bottom: 0.8rem;">✓ {t('pricing.feature.updates')}</li>
					</ul>
					<a href="https://aion.7caifei.com/buy" class="btn btn-primary" style="width: 100%;">{t('pricing.buy')}</a>
				</div>
			</div>
		</section>
		
		<section id="faq" class="container" style="padding: 100px 0; max-width: 800px; margin: 0 auto;">
			<h2 style="font-size: 2.5rem; text-align: center; margin-bottom: 3rem;">{t('faq.title')}</h2>
			<div class="faq-accordion">
				{[1, 2, 3, 4, 5, 6].map((i) => (
					<details class="faq-item">
						<summary>
							{t(`faq.q${i}.q`)}
							<svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
						</summary>
						<div class="faq-content">
							<p>{t(`faq.q${i}.a`)}</p>
						</div>
					</details>
				))}
			</div>
		</section>

		<section class="container" style="padding: 100px 0; text-align: center; border-top: 1px solid var(--border);">
			<h2 style="margin-bottom: 1.5rem;">{t('cta.title')}</h2>
			<div style="display: flex; flex-direction: column; align-items: center; gap: 0.8rem;">
				<a href="/download/Aion.dmg" class="btn btn-primary">{t('cta.btn')}</a>
				<p class="system-requirement">{t('hero.system')}</p>
			</div>
		</section>
	</main>
</BaseLayout>
